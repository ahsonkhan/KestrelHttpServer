<Project>
  <Import Project="$(MSBuildThisFileDirectory)\corefxlab.props" />

  <Target Name="CodeGen">
    <Exec Command="dotnet run" WorkingDirectory="$(MSBuildThisFileDirectory)..\tools\CodeGenerator\" />
  </Target>
  <Target Name="GitSubmoduleInit">
    <Exec Command="git submodule init" WorkingDirectory="$(MSBuildThisFileDirectory)..\" />
    <Exec Command="git reset --hard" WorkingDirectory="$(MSBuildThisFileDirectory)..\corefxlab" />
  </Target>
  <Target Name="Internalize" DependsOnTargets="GitSubmoduleInit">
        <PropertyGroup>
            <InternalizeTempFileName>$(MSBuildThisFileDirectory)..\.build\corefxlabfiles.txt</InternalizeTempFileName>
        </PropertyGroup>

        <WriteLinesToFile File="$(InternalizeTempFileName)" Lines="@(CoreFXLabCompile)" Overwrite="true" Encoding="Unicode"/>
        <Exec Command="dotnet run $(InternalizeTempFileName)" WorkingDirectory="$(MSBuildThisFileDirectory)..\tools\Internalizer\" />
  </Target>
</Project>
